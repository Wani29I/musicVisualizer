<!DOCTYPE html>
<html>
  <head>
    <title>Pickr Color Picker</title>
    <script src="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/pickr.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@simonwep/pickr/dist/themes/nano.min.css"
    />
  </head>
  <body>
    <button id="color-picker-button">Pick a color</button>

    <script>
      // Create the Pickr color picker
      const pickr = Pickr.create({
        el: '#color-picker-button',
        theme: 'nano',
        default: '#42445a',
        comparison: false,
        components: {
          preview: true,
          hue: true,
          interaction: {
            input: true,
            save: true,
          },
        },
      })

      // Get the selected color from the cookie, if it exists
      const savedColor = (() => {
        const cookies = document.cookie.split(';')
        for (const cookie of cookies) {
          const parts = cookie.split('=')
          if (parts[0].trim() === 'selectedColor') {
            return parts[1]
          }
        }
        return null
      })()

      // Set the initial color of the page elements
      if (savedColor) {
        document.body.style.backgroundColor = savedColor
      }

      // Listen for changes to the selected color
      pickr.on('change', color => {
        const selectedColor = color.toHEXA().toString()
        document.body.style.backgroundColor = selectedColor
        document.cookie = `selectedColor=${selectedColor}; expires=Tue, 19 Jan 2038 03:14:07 GMT; path=/`
      })
    </script>
  </body>
</html>